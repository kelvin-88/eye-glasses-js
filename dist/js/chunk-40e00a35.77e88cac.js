(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-40e00a35"],{1276:function(t,e,a){"use strict";var i=a("d784"),s=a("44e7"),n=a("825a"),o=a("1d80"),l=a("4840"),r=a("8aa5"),c=a("50c4"),d=a("14c3"),u=a("9263"),p=a("d039"),g=[].push,h=Math.min,m=4294967295,f=!p((function(){return!RegExp(m,"y")}));i("split",2,(function(t,e,a){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,a){var i=String(o(this)),n=void 0===a?m:a>>>0;if(0===n)return[];if(void 0===t)return[i];if(!s(t))return e.call(i,t,n);var l,r,c,d=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,f=new RegExp(t.source,p+"g");while(l=u.call(f,i)){if(r=f.lastIndex,r>h&&(d.push(i.slice(h,l.index)),l.length>1&&l.index<i.length&&g.apply(d,l.slice(1)),c=l[0].length,h=r,d.length>=n))break;f.lastIndex===l.index&&f.lastIndex++}return h===i.length?!c&&f.test("")||d.push(""):d.push(i.slice(h)),d.length>n?d.slice(0,n):d}:"0".split(void 0,0).length?function(t,a){return void 0===t&&0===a?[]:e.call(this,t,a)}:e,[function(e,a){var s=o(this),n=void 0==e?void 0:e[t];return void 0!==n?n.call(e,s,a):i.call(String(s),e,a)},function(t,s){var o=a(i,t,this,s,i!==e);if(o.done)return o.value;var u=n(t),p=String(this),g=l(u,RegExp),v=u.unicode,b=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(f?"y":"g"),_=new g(f?u:"^(?:"+u.source+")",b),C=void 0===s?m:s>>>0;if(0===C)return[];if(0===p.length)return null===d(_,p)?[p]:[];var x=0,I=0,w=[];while(I<p.length){_.lastIndex=f?I:0;var k,y=d(_,f?p:p.slice(I));if(null===y||(k=h(c(_.lastIndex+(f?0:I)),p.length))===x)I=r(p,I,v);else{if(w.push(p.slice(x,I)),w.length===C)return w;for(var L=1;L<=y.length-1;L++)if(w.push(y[L]),w.length===C)return w;I=x=k}}return w.push(p.slice(x)),w}]}),!f)},c52c:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h2",[t._v("圖片儲存列表")]),a("div",{staticClass:"container mt-3"},[a("div",[a("Loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),a("div",{staticClass:"text-right mt-4"},[a("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.openModal("new")}}},[t._v(" 建立新的圖片 ")])]),a("table",{staticClass:"table mt-4"},[t._m(0),a("tbody",t._l(t.orders,(function(e,i){return a("tr",{key:e.id},[a("img",{attrs:{src:e.path,height:"150px",width:"250px"}}),a("td",[a("div",{staticClass:"btn-group"},[a("button",{staticClass:"btn btn-outline-danger btn-sm",on:{click:function(a){return t.openModal("delete",e,i)}}},[t._v(" 刪除 ")])])])])})),0)]),a("pagination",{attrs:{pages:t.pages},on:{"emit-pages":t.getStorage}}),a("div",{staticClass:"modal fade",attrs:{id:"imageModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-xl",attrs:{role:"document"}},[a("div",{staticClass:"modal-content border-0"},[a("div",{staticClass:"modal-header bg-dark text-white"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[a("span",[t._v(t._s(t.title))])]),t._m(1)]),a("div",{staticClass:"modal-body"},[a("Loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),t._m(2)],1),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v(" 取消 ")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.uploadFile}},[t._v(" 確認 ")])])])])]),a("div",{staticClass:"modal fade",attrs:{id:"delImageModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content border-0"},[t._m(3),a("div",{staticClass:"modal-body"},[t._v("是否刪除圖片(刪除後將無法恢復)。")]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v(" 取消 ")]),a("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:t.delImage}},[t._v(" 確認刪除 ")])])])])])],1)])])},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("圖片")]),a("th",{attrs:{width:"120"}},[t._v("編輯")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("input",{staticClass:"form-control",attrs:{id:"customFile",type:"file"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header bg-danger text-white"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[a("span",[t._v("刪除圖片")])]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],n=(a("99af"),a("ac1f"),a("1276"),a("e20e")),o=a("1157"),l=a.n(o),r={components:{Pagination:n["a"]},created:function(){this.getStorage(1)},props:["token"],methods:{uploadFile:function(){var t=this;this.isLoading=!0;var e="".concat("https://course-ec-api.hexschool.io/","api/").concat("92f42149-8598-4890-ac28-c09272379b59","/admin/storage"),a=document.querySelector("#customFile").files[0],i=new FormData;i.append("file",a),this.$http.post(e,i,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){t.isLoading=!1,console.log(e),l()("#imageModal").modal("hide"),t.refreshScreen()})).catch((function(e){t.isLoading=!1,console.log(e),l()("#imageModal").modal("hide")}))},refreshScreen:function(){this.getStorage(this.pages.current_page)},getStorage:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0;var a="".concat("https://course-ec-api.hexschool.io/","api/").concat("92f42149-8598-4890-ac28-c09272379b59","/admin/storage?page=").concat(e);this.$http.get(a).then((function(e){t.isLoading=!1,console.log(e.data.data),t.orders=e.data.data,t.pages.current_page=e.data.meta.pagination.current_page,t.pages.total_pages=e.data.meta.pagination.total_pages,console.log(t.orders)})).catch((function(e){console.log(e),t.isLoading=!1}))},updateCoupon:function(){var t,e=this;switch(console.log(this.tempImage),this.tempImage.deadline_at=this.deadline.toISOString().split("T")[0],this.tempImage.deadline_at=this.tempImage.deadline_at+" 23:59:59",this.isNew){case!0:t="".concat("https://course-ec-api.hexschool.io/","api/").concat("92f42149-8598-4890-ac28-c09272379b59","/admin/ec/coupon"),this.$http.post(t,this.tempImage).then((function(t){console.log(e.tempImage),l()("#imageModal").modal("hide"),e.refreshScreen()})).catch((function(t){console.log(t),alert(t.response.data.message)}));break;case!1:t="".concat("https://course-ec-api.hexschool.io/","api/").concat("92f42149-8598-4890-ac28-c09272379b59","/admin/ec/coupon/").concat(this.tempImage.id),this.$http.patch(t,this.tempImage).then((function(t){e.refreshScreen(),l()("#imageModal").modal("hide")})).catch((function(t){console.log(t),alert(t.response.data.message)})),this.orders[this.tempIndex]=this.tempImage,this.$set(this.orders,this.tempIndex,this.tempImage);break}},openModal:function(t,e,a){switch(this.tempIndex=a,console.log(this.tempIndex),t){case"new":this.title="新增圖片",this.tempImage={},this.isNew=!0,document.querySelector("#customFile").value=[],l()("#imageModal").modal("show");break;case"edit":this.title="編輯圖片",this.tempImage=Object.assign({},e),this.isNew=!1,this.deadline=new Date(e.deadline.datetime),l()("#imageModal").modal("show");break;case"delete":l()("#delImageModal").modal("show"),this.tempImage=Object.assign({},e);break;default:break}},delImage:function(){var t,e=this;this.isLoading=!0,console.log(this.tempImage),t="".concat("https://course-ec-api.hexschool.io/","api/").concat("92f42149-8598-4890-ac28-c09272379b59","/admin/storage/").concat(this.tempImage.id),this.$http.delete(t,this.tempImage).then((function(t){e.isLoading=!1,l()("#del ImageModal").modal("hide"),e.refreshScreen()})).catch((function(t){e.isLoading=!1,console.log(t),alert(t.response.data.message)}))}},data:function(){return{deadline:new Date("2011-04-11T10:20:30Z"),isLoading:!1,filePath:"",title:"",orders:[],tempImage:{id:"",path:""},tempIndex:0,user:{token:"",uuid:""},pages:{current_page:1,total_pages:0}}}},c=r,d=a("2877"),u=Object(d["a"])(c,i,s,!1,null,null,null);e["default"]=u.exports},e20e:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("nav",{attrs:{"aria-label":"Page navigation example"}},[a("ul",{staticClass:"pagination"},[a("li",{staticClass:"page-item",class:{disabled:1===t.pages.current_page}},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Previous"},on:{click:function(e){return e.preventDefault(),t.emitPages(t.pages.current_page-1)}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("«")])])]),t._l(t.pages.total_pages,(function(e,i){return a("li",{key:i,staticClass:"page-item",class:{active:e===t.pages.current_page}},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.emitPages(e)}}},[t._v(t._s(e))])])})),a("li",{staticClass:"page-item",class:{disabled:t.pages.current_page===t.pages.total_pages}},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Next"},on:{click:function(e){return e.preventDefault(),t.emitPages(t.pages.current_page+1)}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("»")])])])],2)])},s=[],n={data:function(){return{}},props:{pages:{}},methods:{emitPages:function(t){this.$emit("emit-pages",t)}}},o=n,l=a("2877"),r=Object(l["a"])(o,i,s,!1,null,null,null);e["a"]=r.exports}}]);
//# sourceMappingURL=chunk-40e00a35.77e88cac.js.map